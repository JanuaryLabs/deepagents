[
  {
    "input": "Provide a query only showing the Customers from Brazil.",
    "expected": "SELECT * FROM Customer WHERE Country = 'Brazil' LIMIT 100;"
  },
  {
    "input": "List all artists in the database.",
    "expected": "SELECT * FROM Artist;"
  },
  {
    "input": "Show all genres available in the music store.",
    "expected": "SELECT * FROM Genre;"
  },
  {
    "input": "Find all tracks that cost more than $0.99.",
    "expected": "SELECT * FROM Track WHERE UnitPrice > 0.99;"
  },
  {
    "input": "List all employees who have the title \"Sales Support Agent\".",
    "expected": "SELECT * FROM Employee WHERE Title = 'Sales Support Agent';"
  },
  {
    "input": "Show all customers from Canada.",
    "expected": "SELECT * FROM Customer WHERE Country = 'Canada';"
  },
  {
    "input": "Find all tracks longer than 5 minutes.",
    "expected": "SELECT * FROM Track WHERE Milliseconds > 300000;"
  },
  {
    "input": "List all albums sorted by title alphabetically.",
    "expected": "SELECT * FROM Album ORDER BY Title ASC;"
  },
  {
    "input": "Show the first 10 tracks in the database.",
    "expected": "SELECT * FROM Track LIMIT 10;"
  },
  {
    "input": "Provide a query showing the Invoices of customers who are from Brazil. The resultant table should show the customer's full name, Invoice ID, Date of the invoice and billing country.",
    "expected": "SELECT c.FirstName || ' ' || c.LastName as Name, i.InvoiceId, i.InvoiceDate, i.BillingCountry FROM Customer c JOIN Invoice i ON i.CustomerId = c.CustomerId WHERE c.Country = 'Brazil';"
  },
  {
    "input": "List all albums with their artist names.",
    "expected": "SELECT al.Title AS AlbumTitle, ar.Name AS ArtistName FROM Album al JOIN Artist ar ON al.ArtistId = ar.ArtistId;"
  },
  {
    "input": "Show all tracks with their genre names.",
    "expected": "SELECT t.Name AS TrackName, g.Name AS GenreName FROM Track t JOIN Genre g ON t.GenreId = g.GenreId;"
  },
  {
    "input": "List all tracks with their media type.",
    "expected": "SELECT t.Name AS TrackName, mt.Name AS MediaType FROM Track t JOIN MediaType mt ON t.MediaTypeId = mt.MediaTypeId;"
  },
  {
    "input": "Show all customers with their support representative name.",
    "expected": "SELECT c.FirstName || ' ' || c.LastName AS CustomerName, e.FirstName || ' ' || e.LastName AS SupportRep FROM Customer c JOIN Employee e ON c.SupportRepId = e.EmployeeId;"
  },
  {
    "input": "List all invoice line items with their track names.",
    "expected": "SELECT il.*, t.Name AS TrackName FROM InvoiceLine il JOIN Track t ON il.TrackId = t.TrackId;"
  },
  {
    "input": "Provide a query showing a unique list of billing countries from the Invoice table.",
    "expected": "SELECT DISTINCT BillingCountry FROM Invoice;"
  },
  {
    "input": "How many customers are there in total?",
    "expected": "SELECT COUNT(*) AS TotalCustomers FROM Customer;"
  },
  {
    "input": "What is the total number of tracks in the database?",
    "expected": "SELECT COUNT(*) AS TotalTracks FROM Track;"
  },
  {
    "input": "How many albums does each artist have?",
    "expected": "SELECT ar.Name AS ArtistName, COUNT(al.AlbumId) AS AlbumCount FROM Artist ar LEFT JOIN Album al ON ar.ArtistId = al.ArtistId GROUP BY ar.ArtistId ORDER BY AlbumCount DESC;"
  },
  {
    "input": "What is the average track length in minutes?",
    "expected": "SELECT AVG(Milliseconds / 60000.0) AS AvgMinutes FROM Track;"
  },
  {
    "input": "Show the total sales amount for all invoices.",
    "expected": "SELECT SUM(Total) AS TotalSales FROM Invoice;"
  },
  {
    "input": "How many tracks are in each genre?",
    "expected": "SELECT g.Name AS GenreName, COUNT(t.TrackId) AS TrackCount FROM Genre g LEFT JOIN Track t ON g.GenreId = t.GenreId GROUP BY g.GenreId ORDER BY TrackCount DESC;"
  },
  {
    "input": "What is the average invoice total?",
    "expected": "SELECT AVG(Total) AS AvgInvoiceTotal FROM Invoice;"
  },
  {
    "input": "Looking at the InvoiceLine table, provide a query that COUNTs the number of line items for Invoice ID 37.",
    "expected": "SELECT COUNT(*) FROM InvoiceLine WHERE InvoiceId = 37;"
  },
  {
    "input": "Looking at the InvoiceLine table, provide a query that COUNTs the number of line items for each Invoice.",
    "expected": "SELECT InvoiceId, COUNT(*) AS LineItemCount FROM InvoiceLine GROUP BY InvoiceId;"
  },
  {
    "input": "Provide a query that shows the # of invoices per country.",
    "expected": "SELECT BillingCountry, COUNT(*) AS InvoiceCount FROM Invoice GROUP BY BillingCountry ORDER BY InvoiceCount DESC;"
  },
  {
    "input": "Provide a query that shows the total number of tracks in each playlist. The Playlist name should be included on the resultant table.",
    "expected": "SELECT p.Name AS PlaylistName, COUNT(pt.TrackId) AS TrackCount FROM Playlist p LEFT JOIN PlaylistTrack pt ON p.PlaylistId = pt.PlaylistId GROUP BY p.PlaylistId;"
  },
  {
    "input": "Provide a query that shows the invoices associated with each sales agent. The resultant table should include the Sales Agent's full name.",
    "expected": "SELECT i.*, e.FirstName || ' ' || e.LastName AS SalesAgentName FROM Invoice i JOIN Customer c ON i.CustomerId = c.CustomerId JOIN Employee e ON c.SupportRepId = e.EmployeeId WHERE e.Title LIKE '%Sales%Agent%';"
  },
  {
    "input": "Provide a query that shows the Invoice Total, Customer name, Country and Sale Agent name for all invoices and customers.",
    "expected": "SELECT c.FirstName || ' ' || c.LastName AS CustomerName, e.FirstName || ' ' || e.LastName AS SalesAgentName, i.Total, i.BillingCountry FROM Invoice i JOIN Customer c ON c.CustomerId = i.CustomerId JOIN Employee e ON c.SupportRepId = e.EmployeeId;"
  },
  {
    "input": "Provide a query that includes the purchased track name AND artist name with each invoice line item.",
    "expected": "SELECT il.InvoiceLineId, il.InvoiceId, t.Name AS TrackName, ar.Name AS ArtistName, il.UnitPrice, il.Quantity FROM InvoiceLine il JOIN Track t ON il.TrackId = t.TrackId JOIN Album al ON t.AlbumId = al.AlbumId JOIN Artist ar ON al.ArtistId = ar.ArtistId;"
  },
  {
    "input": "Provide a query that shows all the Tracks, but displays no IDs. The resultant table should include the Album name, Media type and Genre.",
    "expected": "SELECT t.Name AS TrackName, al.Title AS AlbumTitle, mt.Name AS MediaType, g.Name AS Genre FROM Track t JOIN Album al ON t.AlbumId = al.AlbumId JOIN MediaType mt ON t.MediaTypeId = mt.MediaTypeId JOIN Genre g ON t.GenreId = g.GenreId;"
  },
  {
    "input": "List all tracks by AC/DC including album name and genre.",
    "expected": "SELECT t.Name AS TrackName, al.Title AS AlbumTitle, g.Name AS Genre FROM Track t JOIN Album al ON t.AlbumId = al.AlbumId JOIN Artist ar ON al.ArtistId = ar.ArtistId JOIN Genre g ON t.GenreId = g.GenreId WHERE ar.Name = 'AC/DC';"
  },
  {
    "input": "Show all rock tracks with their artist name, album title, and duration.",
    "expected": "SELECT t.Name AS TrackName, ar.Name AS ArtistName, al.Title AS AlbumTitle, t.Milliseconds / 1000 AS DurationSeconds FROM Track t JOIN Album al ON t.AlbumId = al.AlbumId JOIN Artist ar ON al.ArtistId = ar.ArtistId JOIN Genre g ON t.GenreId = g.GenreId WHERE g.Name = 'Rock';"
  },
  {
    "input": "How many Invoices were there in 2009 and 2011? What are the respective total sales for each of those years?",
    "expected": "SELECT strftime('%Y', InvoiceDate) AS Year, COUNT(*) AS InvoiceCount, SUM(Total) AS TotalSales FROM Invoice WHERE strftime('%Y', InvoiceDate) IN ('2009', '2011') GROUP BY Year ORDER BY Year;"
  },
  {
    "input": "Show all invoices from the year 2010.",
    "expected": "SELECT * FROM Invoice WHERE strftime('%Y', InvoiceDate) = '2010';"
  },
  {
    "input": "What were the total sales for each month in 2012?",
    "expected": "SELECT strftime('%m', InvoiceDate) AS Month, SUM(Total) AS TotalSales FROM Invoice WHERE strftime('%Y', InvoiceDate) = '2012' GROUP BY Month ORDER BY Month;"
  },
  {
    "input": "List employees hired after 2002.",
    "expected": "SELECT * FROM Employee WHERE strftime('%Y', HireDate) > '2002';"
  },
  {
    "input": "Which sales agent made the most in sales in 2009?",
    "expected": "SELECT e.FirstName || ' ' || e.LastName AS SalesAgent, SUM(i.Total) AS TotalSales FROM Employee e JOIN Customer c ON c.SupportRepId = e.EmployeeId JOIN Invoice i ON i.CustomerId = c.CustomerId WHERE strftime('%Y', i.InvoiceDate) = '2009' GROUP BY e.EmployeeId ORDER BY TotalSales DESC LIMIT 1;"
  },
  {
    "input": "Show monthly invoice counts for the last 3 years in the database.",
    "expected": "SELECT strftime('%Y-%m', InvoiceDate) AS YearMonth, COUNT(*) AS InvoiceCount FROM Invoice GROUP BY YearMonth ORDER BY YearMonth DESC LIMIT 36;"
  },
  {
    "input": "Provide a query that shows the top 5 most purchased tracks over all.",
    "expected": "SELECT t.Name AS TrackName, COUNT(il.InvoiceLineId) AS PurchaseCount FROM InvoiceLine il JOIN Track t ON il.TrackId = t.TrackId GROUP BY t.TrackId ORDER BY PurchaseCount DESC LIMIT 5;"
  },
  {
    "input": "Provide a query that shows the top 3 best selling artists.",
    "expected": "SELECT ar.Name AS ArtistName, COUNT(il.InvoiceLineId) AS SalesCount FROM InvoiceLine il JOIN Track t ON il.TrackId = t.TrackId JOIN Album al ON t.AlbumId = al.AlbumId JOIN Artist ar ON al.ArtistId = ar.ArtistId GROUP BY ar.ArtistId ORDER BY SalesCount DESC LIMIT 3;"
  },
  {
    "input": "Provide a query that shows the most purchased Media Type.",
    "expected": "SELECT mt.Name AS MediaType, COUNT(il.InvoiceLineId) AS PurchaseCount FROM InvoiceLine il JOIN Track t ON il.TrackId = t.TrackId JOIN MediaType mt ON t.MediaTypeId = mt.MediaTypeId GROUP BY mt.MediaTypeId ORDER BY PurchaseCount DESC LIMIT 1;"
  },
  {
    "input": "Who are the top 5 customers by total purchase amount?",
    "expected": "SELECT c.FirstName || ' ' || c.LastName AS CustomerName, SUM(i.Total) AS TotalPurchases FROM Customer c JOIN Invoice i ON c.CustomerId = i.CustomerId GROUP BY c.CustomerId ORDER BY TotalPurchases DESC LIMIT 5;"
  },
  {
    "input": "What are the 10 longest tracks in the database?",
    "expected": "SELECT Name, Milliseconds / 60000.0 AS Minutes FROM Track ORDER BY Milliseconds DESC LIMIT 10;"
  },
  {
    "input": "Which genre has the most tracks?",
    "expected": "SELECT g.Name AS GenreName, COUNT(t.TrackId) AS TrackCount FROM Genre g JOIN Track t ON g.GenreId = t.GenreId GROUP BY g.GenreId ORDER BY TrackCount DESC LIMIT 1;"
  },
  {
    "input": "List the top 5 countries by number of customers.",
    "expected": "SELECT Country, COUNT(*) AS CustomerCount FROM Customer GROUP BY Country ORDER BY CustomerCount DESC LIMIT 5;"
  },
  {
    "input": "Provide a query that shows all Invoices but includes the # of invoice line items.",
    "expected": "SELECT i.*, COUNT(il.InvoiceLineId) AS LineItemCount FROM Invoice i LEFT JOIN InvoiceLine il ON i.InvoiceId = il.InvoiceId GROUP BY i.InvoiceId;"
  },
  {
    "input": "Provide a query that shows total sales made by each sales agent.",
    "expected": "SELECT e.FirstName || ' ' || e.LastName AS SalesAgent, SUM(i.Total) AS TotalSales FROM Employee e JOIN Customer c ON c.SupportRepId = e.EmployeeId JOIN Invoice i ON i.CustomerId = c.CustomerId GROUP BY e.EmployeeId ORDER BY TotalSales DESC;"
  },
  {
    "input": "Provide a query that shows the # of customers assigned to each sales agent.",
    "expected": "SELECT e.FirstName || ' ' || e.LastName AS SalesAgent, COUNT(c.CustomerId) AS CustomerCount FROM Employee e LEFT JOIN Customer c ON e.EmployeeId = c.SupportRepId WHERE e.Title LIKE '%Sales%Agent%' GROUP BY e.EmployeeId;"
  },
  {
    "input": "Provide a query that shows the total sales per country. Which country's customers spent the most?",
    "expected": "SELECT BillingCountry, SUM(Total) AS TotalSales FROM Invoice GROUP BY BillingCountry ORDER BY TotalSales DESC;"
  },
  {
    "input": "What is the revenue breakdown by genre?",
    "expected": "SELECT g.Name AS Genre, SUM(il.UnitPrice * il.Quantity) AS Revenue FROM InvoiceLine il JOIN Track t ON il.TrackId = t.TrackId JOIN Genre g ON t.GenreId = g.GenreId GROUP BY g.GenreId ORDER BY Revenue DESC;"
  },
  {
    "input": "Calculate the average number of tracks per album.",
    "expected": "SELECT AVG(TrackCount) AS AvgTracksPerAlbum FROM (SELECT AlbumId, COUNT(*) AS TrackCount FROM Track GROUP BY AlbumId);"
  },
  {
    "input": "Show total revenue per artist.",
    "expected": "SELECT ar.Name AS ArtistName, SUM(il.UnitPrice * il.Quantity) AS TotalRevenue FROM InvoiceLine il JOIN Track t ON il.TrackId = t.TrackId JOIN Album al ON t.AlbumId = al.AlbumId JOIN Artist ar ON al.ArtistId = ar.ArtistId GROUP BY ar.ArtistId ORDER BY TotalRevenue DESC;"
  },
  {
    "input": "Find all tracks that are longer than the average track length.",
    "expected": "SELECT * FROM Track WHERE Milliseconds > (SELECT AVG(Milliseconds) FROM Track);"
  },
  {
    "input": "List all customers who have made at least one purchase.",
    "expected": "SELECT * FROM Customer WHERE CustomerId IN (SELECT DISTINCT CustomerId FROM Invoice);"
  },
  {
    "input": "Find artists who have more than 10 albums.",
    "expected": "SELECT ar.Name FROM Artist ar WHERE ar.ArtistId IN (SELECT ArtistId FROM Album GROUP BY ArtistId HAVING COUNT(*) > 10);"
  },
  {
    "input": "Show tracks that have never been purchased.",
    "expected": "SELECT * FROM Track WHERE TrackId NOT IN (SELECT DISTINCT TrackId FROM InvoiceLine);"
  },
  {
    "input": "List albums that have more tracks than the average tracks per album.",
    "expected": "SELECT al.Title, COUNT(t.TrackId) AS TrackCount FROM Album al JOIN Track t ON al.AlbumId = t.AlbumId GROUP BY al.AlbumId HAVING COUNT(t.TrackId) > (SELECT AVG(cnt) FROM (SELECT COUNT(*) AS cnt FROM Track GROUP BY AlbumId));"
  },
  {
    "input": "Show the employee hierarchy - list each employee with their manager.",
    "expected": "SELECT e.FirstName || ' ' || e.LastName AS Employee, m.FirstName || ' ' || m.LastName AS Manager FROM Employee e LEFT JOIN Employee m ON e.ReportsTo = m.EmployeeId;"
  },
  {
    "input": "List all employees who report to Andrew Adams.",
    "expected": "SELECT e.FirstName, e.LastName, e.Title FROM Employee e JOIN Employee m ON e.ReportsTo = m.EmployeeId WHERE m.FirstName = 'Andrew' AND m.LastName = 'Adams';"
  },
  {
    "input": "Find all employees who do not have a manager.",
    "expected": "SELECT * FROM Employee WHERE ReportsTo IS NULL;"
  },
  {
    "input": "List all playlists and how many tracks they contain.",
    "expected": "SELECT p.Name AS PlaylistName, COUNT(pt.TrackId) AS TrackCount FROM Playlist p LEFT JOIN PlaylistTrack pt ON p.PlaylistId = pt.PlaylistId GROUP BY p.PlaylistId ORDER BY TrackCount DESC;"
  },
  {
    "input": "Show all tracks in the \"Music\" playlist.",
    "expected": "SELECT t.Name AS TrackName FROM Track t JOIN PlaylistTrack pt ON t.TrackId = pt.TrackId JOIN Playlist p ON pt.PlaylistId = p.PlaylistId WHERE p.Name = 'Music';"
  },
  {
    "input": "Which playlist has the longest total duration?",
    "expected": "SELECT p.Name AS PlaylistName, SUM(t.Milliseconds) / 60000.0 AS TotalMinutes FROM Playlist p JOIN PlaylistTrack pt ON p.PlaylistId = pt.PlaylistId JOIN Track t ON pt.TrackId = t.TrackId GROUP BY p.PlaylistId ORDER BY TotalMinutes DESC LIMIT 1;"
  },
  {
    "input": "Find tracks that appear in more than one playlist.",
    "expected": "SELECT t.Name AS TrackName, COUNT(DISTINCT pt.PlaylistId) AS PlaylistCount FROM Track t JOIN PlaylistTrack pt ON t.TrackId = pt.TrackId GROUP BY t.TrackId HAVING COUNT(DISTINCT pt.PlaylistId) > 1 ORDER BY PlaylistCount DESC;"
  },
  {
    "input": "Find all tracks with NULL composer.",
    "expected": "SELECT * FROM Track WHERE Composer IS NULL;"
  },
  {
    "input": "List customers whose company is not specified.",
    "expected": "SELECT * FROM Customer WHERE Company IS NULL OR Company = '';"
  },
  {
    "input": "Find the smallest and largest invoice totals.",
    "expected": "SELECT MIN(Total) AS MinInvoice, MAX(Total) AS MaxInvoice FROM Invoice;"
  },
  {
    "input": "Show the price range of tracks (minimum and maximum unit price).",
    "expected": "SELECT MIN(UnitPrice) AS MinPrice, MAX(UnitPrice) AS MaxPrice FROM Track;"
  },
  {
    "input": "Count how many different composers are in the database.",
    "expected": "SELECT COUNT(DISTINCT Composer) AS UniqueComposers FROM Track WHERE Composer IS NOT NULL;"
  },
  {
    "input": "Get me all the Iron Maiden songs.",
    "expected": "SELECT t.Name AS TrackName FROM Track t JOIN Album al ON t.AlbumId = al.AlbumId JOIN Artist ar ON al.ArtistId = ar.ArtistId WHERE ar.Name = 'Iron Maiden';"
  },
  {
    "input": "How much money did we make in total?",
    "expected": "SELECT SUM(Total) AS TotalRevenue FROM Invoice;"
  },
  {
    "input": "Who bought the most stuff?",
    "expected": "SELECT c.FirstName || ' ' || c.LastName AS CustomerName, SUM(i.Total) AS TotalSpent FROM Customer c JOIN Invoice i ON c.CustomerId = i.CustomerId GROUP BY c.CustomerId ORDER BY TotalSpent DESC LIMIT 1;"
  },
  {
    "input": "What genres do we have?",
    "expected": "SELECT Name FROM Genre;"
  },
  {
    "input": "Show me everything about customer #5.",
    "expected": "SELECT * FROM Customer WHERE CustomerId = 5;"
  },
  {
    "input": "I want to see all jazz tracks.",
    "expected": "SELECT t.* FROM Track t JOIN Genre g ON t.GenreId = g.GenreId WHERE g.Name = 'Jazz';"
  },
  {
    "input": "Which employees are from Calgary?",
    "expected": "SELECT * FROM Employee WHERE City = 'Calgary';"
  },
  {
    "input": "Give me a list of all the different media types.",
    "expected": "SELECT * FROM MediaType;"
  }
]
